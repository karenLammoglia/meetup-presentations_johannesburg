---
title: "Import"
#subtitle: "âš”<br/>with xaringan"
author: "Luis de Sousa"
date: "2018/10/01 (updated: `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r import-setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

# Importing Data

* R can import data from just about every form imaginable:
* Flat files like plain text and delimited data: .txt, .csv, .tsv
* Data files from proprietary software like MS Excel, SPSS, SAS
* Directly from Databases: MySQL, MS SQL Server, PostgreSQL
* Directly from the Web: APIs, JSON, Webscrape HTML

---

# Importing Data - CSV

```{r Importing Data - CSV, message=FALSE, warning=FALSE}
library(tidyverse) # load full suite of packages for data analysis
library(babynames) # Full baby name data provided by the SSA
baby_names <- babynames %>% filter(sex == 'F') # import all female baby names
baby_names # preview the data
```

---

# Importing Data - Multiple Excel Sheets to 1 Data Frame

```{r Importing Data - Multiple Excel Sheets to 1 Data Frame, message=FALSE, warning=FALSE}
library(readxl) # for reading excel files
path <- "data/gapminder_messy.xlsx"
combined_data <- excel_sheets(path) %>% 
  map_df(~ {
    read_excel(path, sheet = .x, 
               skip = 4, trim_ws = TRUE) %>% 
      mutate(year = as.numeric(.x))
  }) %>% 
  select(country, year, everything())
# show top and bottom 6 rows of data frame
head(combined_data)
tail(combined_data)
```

---

# Importing Data - SPSS

You don't have to pay expensive SPSS licenses to analyse your survey data!

```{r, Importing Data - SPSS}
library(haven) # for reading SPSS, SAS, STATA files
survey_data <- read_sav("data/sample_spss_data.sav")
head(survey_data)
# convert spss label codes into labels
labelled_survey_data <- as_factor(survey_data)
head(labelled_survey_data)
labelled_survey_data %>% 
count(fQ1bGender, dAge) %>% 
spread(fQ1bGender, n) %>% 
knitr::kable(format = "html")
```

